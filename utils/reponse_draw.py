import numpy as np
from matplotlib import pyplot as plt


def response1_1():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Model Accuracy", fontdict={'size': 30})
    plt.xticks(np.arange(0, 201, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 100)

    x = []
    for i in range(0, 100):
        x.append(i)

    vert_fedavg_acc = [9.49, 9.379999999999999, 9.3, 9.34, 9.65, 10.23, 11.07, 12.17, 14.069999999999999, 15.379999999999999, 17.18, 19.11, 21.959999999999997, 27.060000000000002, 31.66, 35.120000000000005, 37.44, 39.22, 41.21, 42.79, 43.980000000000004, 45.379999999999995, 46.19, 47.4, 48.51, 49.6, 51.53, 55.230000000000004, 57.379999999999995, 59.99, 62.71, 65.52, 67.55, 70.24000000000001, 72.48, 73.89, 75.22, 77.18, 78.38000000000001, 79.46, 80.7, 81.16, 82.3, 82.65, 83.47, 84.22, 84.49, 85.05, 85.49, 85.89, 86.27, 86.47, 86.87, 87.39, 87.52, 87.96000000000001, 88.21, 88.47, 88.8, 88.88000000000001, 89.23, 89.37, 89.44, 89.77000000000001, 89.97, 90.16999999999999, 90.23, 90.42, 90.60000000000001, 90.53, 90.74, 90.92, 90.99000000000001, 91.10000000000001, 91.23, 91.32000000000001, 91.28, 91.44, 91.47999999999999, 91.59, 91.67, 91.64999999999999, 91.86, 91.75, 91.82000000000001, 91.97, 91.97999999999999, 92.11, 92.12, 92.24, 92.24, 92.31, 92.36999999999999, 92.4, 92.47999999999999, 92.5, 92.51, 92.60000000000001, 92.55, 92.67]

    god_fedavg = [14.74, 14.93, 15.040000000000001, 15.32, 15.909999999999998, 16.54, 17.37, 17.68, 17.810000000000002, 18.060000000000002, 18.44, 19.78, 21.55, 24.21, 31.540000000000003, 36.230000000000004, 38.56, 39.57, 39.57, 40.19, 41.089999999999996, 42.13, 43.78, 46.69, 50.91, 54.449999999999996, 60.34, 64.38000000000001, 67.45, 70.17999999999999, 72.2, 73.91, 75.24, 76.44999999999999, 77.61, 78.89, 79.55, 79.63, 80.72, 81.17999999999999, 81.6, 82.3, 82.62, 83.08, 83.17, 83.67, 84.2, 84.55, 84.65, 85.08, 85.39, 85.72, 86.27, 86.28, 86.63, 86.71, 87.3, 87.59, 87.75, 87.86, 88.05, 88.4, 88.74, 88.78, 88.79, 89.08, 89.33, 89.32, 89.53, 89.71000000000001, 89.9, 89.94, 90.12, 90.16, 90.25, 90.49000000000001, 90.46, 90.58, 90.68, 90.89, 91.14999999999999, 91.01, 91.16, 91.28, 91.39, 91.34, 91.57, 91.47999999999999, 91.57, 91.78, 91.91, 91.83, 91.9, 92.0, 92.04, 92.04, 92.19000000000001, 92.2, 92.29, 92.32000000000001]

    plt.plot(x, vert_fedavg_acc, '*-', markersize=0, linewidth=3, c='#2dabb2', label='VERT+FedAvg', alpha=1)
    plt.plot(x, god_fedavg, 'o-', markersize=0, linewidth=3, c='#daab36', label='FedAvgG', alpha=1)
    plt.legend(fontsize=30)

    plt.show()
    fig.savefig('/home/ln/JinBo/code/Against-Large-Scale-Poison/result/response1_1.pdf', bbox_inches='tight')


def response1_2():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Detection Accuracy", fontdict={'size': 30})

    x = [1,2,3,4,5]

    plt.xticks(x, ['t+1', 't+2', 't+3', 't+4', 't+5'], size=30)
    plt.yticks(size=30)

    detection_acc = [100, 72, 66, 60, 58]

    plt.plot(x, detection_acc, '*-', markersize=30, linewidth=3, c='#2dabb2', alpha=1)
    plt.legend(fontsize=30)

    plt.show()
    fig.savefig('/home/ln/JinBo/code/Against-Large-Scale-Poison/result/response1_2.pdf', bbox_inches='tight')


def response1_3():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Cosine Similarity", fontdict={'size': 30})
    plt.xticks(np.arange(0, 101, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 100)

    x = []
    for i in range(0, 100):
        x.append(i)

    honest_cos = [0.0, 0.0, 0.6860011219978333, 0.7396278381347656, 0.7488535642623901, 0.7614473700523376, 0.7534860372543335, 0.7842375040054321, 0.7725707292556763, 0.7651958465576172, 0.7597085237503052, 0.7535904049873352, 0.7584306001663208, 0.7458075284957886, 0.7360911965370178, 0.8314250111579895, 0.7457926869392395, 0.7549961805343628, 0.7441809177398682, 0.7445033192634583, 0.7541402578353882, 0.8007643222808838, 0.7532678842544556, 0.819429337978363, 0.7703097462654114, 0.7560624480247498, 0.7823693156242371, 0.792160153388977, 0.762191116809845, 0.7937792539596558, 0.7356487512588501, 0.7757596969604492, 0.7770237922668457, 0.7639784812927246, 0.7767001390457153, 0.8127434253692627, 0.8075260519981384, 0.8254153728485107, 0.7715296149253845, 0.8004857301712036, 0.7886770963668823, 0.7636121511459351, 0.7203546762466431, 0.7393411993980408, 0.7875048518180847, 0.7843178510665894, 0.8199609518051147, 0.7764444351196289, 0.7634870409965515, 0.7183285355567932, 0.799841046333313, 0.7731951475143433, 0.7270822525024414, 0.7589107751846313, 0.7788878679275513, 0.7604197263717651, 0.7532802224159241, 0.7242750525474548, 0.7823795080184937, 0.7339237332344055, 0.8008880615234375, 0.7804139256477356, 0.766688883304596, 0.8280512690544128, 0.7473746538162231, 0.7840795516967773, 0.8009638786315918, 0.7911668419837952, 0.7371325492858887, 0.7244608998298645, 0.7526799440383911, 0.778569757938385, 0.7868862152099609, 0.7628162503242493, 0.8337961435317993, 0.8163549304008484, 0.7202451825141907, 0.7699783444404602, 0.7535371780395508, 0.7881795167922974, 0.7447736859321594, 0.7359026074409485, 0.7709472179412842, 0.7841916680335999, 0.762253999710083, 0.7611936926841736, 0.7899649143218994, 0.8437914848327637, 0.7517838478088379, 0.7777913212776184, 0.7743126153945923, 0.7613774538040161, 0.7784512042999268, 0.7859965562820435, 0.7551156282424927, 0.7375879883766174, 0.7871385812759399, 0.7733914852142334, 0.7704452872276306, 0.7757201194763184]

    malicious_cos = [0.0, 0.0, 0.8338586091995239, 0.6378793120384216, 0.7945038080215454, 0.7484465837478638, 0.49491769075393677, 0.3879621624946594, 0.6748471260070801, 0.40962323546409607, 0.7579488754272461, 0.8676724433898926, 0.8151005506515503, 0.8147029280662537, 0.873877763748169, 0.2705715596675873, 0.8174649477005005, 0.8143423795700073, 0.8883515000343323, 0.8157073259353638, 0.7741268277168274, 0.5361340045928955, 0.8969572186470032, 0.6127138137817383, 0.8712035417556763, 0.9246776103973389, 0.8975976705551147, 0.5711194276809692, 0.8749566674232483, 0.8295912742614746, 0.8922436237335205, 0.9042679667472839, 0.7803539037704468, 0.8221880793571472, 0.8299718499183655, 0.34684130549430847, 0.28304335474967957, 0.7626374959945679, 0.8904775977134705, 0.4863470196723938, 0.9166683554649353, 0.8844622373580933, 0.8612949252128601, 0.9166994094848633, 0.8549339771270752, 0.9195326566696167, 0.3652103841304779, 0.77583247423172, 0.9193041324615479, 0.8703321218490601, 0.12540461122989655, 0.013379687443375587, 0.013835899531841278, -0.19823457300662994, -0.06669575721025467, -0.0733172595500946, 0.06923428177833557, 0.07736121863126755, -0.003179602324962616, 0.016529284417629242, -0.021961554884910583, 0.014887657016515732, -0.06458459794521332, 0.023952387273311615, 0.08883209526538849, -0.05514167249202728, -0.031261175870895386, -0.07413819432258606, 0.04131775349378586, -0.050080254673957825, -0.18502166867256165, 0.1736275851726532, -0.00988805666565895, -0.11131051182746887, -0.262895792722702, -0.011721700429916382, -0.09870155155658722, 0.07598167657852173, 0.019991688430309296, 0.002030564472079277, 0.12217429280281067, -0.07008998095989227, 0.10026176273822784, -0.17865115404129028, -0.0943179577589035, 0.020118966698646545, 0.05541510134935379, 0.12237464636564255, 0.05812424048781395, 0.09565475583076477, -0.02451726794242859, 0.14413726329803467, -0.08754748106002808, 0.0017856992781162262, 0.01747305318713188, 0.03411359712481499, 0.12392246723175049, -0.1119539737701416, 0.003744557499885559, -0.023332398384809494]

    plt.plot(x, honest_cos, '*-', markersize=0, linewidth=3, c='#2dabb2', label='honest', alpha=1)
    plt.plot(x, malicious_cos, 'o-', markersize=0, linewidth=3, c='#daab36', label='malicious', alpha=1)
    plt.legend(fontsize=30)

    plt.show()
    fig.savefig('/home/ln/JinBo/code/Against-Large-Scale-Poison/result/response1_3.pdf', bbox_inches='tight')


def response1_4():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Cosine Similarity", fontdict={'size': 30})
    plt.xticks(np.arange(0, 101, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 100)

    x = []
    for i in range(0, 100):
        x.append(i)

    # linear projector 92.67 100
    honest_cos = [0.0, 0.0, 0.9825040102005005, 0.990559458732605, 0.9849, 0.9835284948348999, 0.984510600566864, 0.9825040102005005, 0.990559458732605, 0.9849827289581299, 0.9891530275344849, 0.9907024502754211, 0.9826435446739197, 0.9886447787284851, 0.9827262163162231, 0.9824336171150208, 0.9877007603645325, 0.9836329817771912, 0.9855300784111023, 0.9906752109527588, 0.9866021871566772, 0.9905319809913635, 0.9874204397201538, 0.9801282286643982, 0.9886379837989807, 0.9814661741256714, 0.9838923811912537, 0.9855104088783264, 0.9822586178779602, 0.9777657985687256, 0.9820535182952881, 0.9797186851501465, 0.9810694456100464, 0.9729285836219788, 0.977690577507019, 0.9718210101127625, 0.9715589284896851, 0.9746684432029724, 0.9720286130905151, 0.9683483242988586, 0.9702794551849365, 0.9689948558807373, 0.9758144617080688, 0.969632089138031, 0.9730046987533569, 0.9676950573921204, 0.969360888004303, 0.966224730014801, 0.9674270153045654, 0.9663450121879578, 0.9680603742599487, 0.9634248614311218, 0.9695484042167664, 0.9678609371185303, 0.963470458984375, 0.9653845429420471, 0.9693644046783447, 0.9638954401016235, 0.9612946510314941, 0.970168948173523, 0.9653828740119934, 0.9680771231651306, 0.9663968682289124, 0.9623128175735474, 0.9710888266563416, 0.96136873960495, 0.9634791612625122, 0.961471676826477, 0.9727471470832825, 0.9683594107627869, 0.9642590284347534, 0.9635971784591675, 0.9648347496986389, 0.9702864289283752, 0.9676203727722168, 0.9698296189308167, 0.9734699726104736, 0.9616876840591431, 0.9662448167800903, 0.9635209441184998, 0.965528666973114, 0.9660534858703613, 0.9676924347877502, 0.9685197472572327, 0.9669725894927979, 0.9609918594360352, 0.9730242490768433, 0.9678725600242615, 0.9707093834877014, 0.9704578518867493, 0.9637817740440369, 0.9754655361175537, 0.9622107148170471, 0.9593466520309448, 0.9741499423980713, 0.9636247754096985, 0.969312310218811, 0.9646830558776855, 0.9696999192237854, 0.9664106965065002]
    malicious_cos = [0.0, 0.0, 0.013741022907197475, 0.026015568524599075, 0.04384359717, 0.02977411262691021, 0.004500740673393011, 0.019143277779221535, 0.013741022907197475, 0.026015568524599075, 0.043843597173690796, 0.028848549351096153, -0.019919276237487793, -0.004918830003589392, 0.0015289544826373458, 0.01347004808485508, 0.010953998193144798, 0.02824687398970127, 0.014102563261985779, -0.007441780995577574, 0.0261309202760458, 0.015139251947402954, -0.0010248020989820361, 0.00505452835932374, 0.020326649770140648, 0.01085104700177908, 0.008472448214888573, -0.003541071666404605, 0.0075286016799509525, 0.00010201055556535721, 0.024242667481303215, 0.0254555344581604, 0.013444981537759304, 0.01601783186197281, 0.01291840709745884, -0.0022793770767748356, -0.006616581231355667, 0.007824576459825039, -0.01999615505337715, -0.00441250205039978, 0.023440087214112282, 0.011359457857906818, -0.0222910325974226, -0.028581777587532997, 0.03640681877732277, -0.016532614827156067, -0.006572565529495478, 0.010409108363091946, 0.010580929927527905, 0.03774598240852356, -0.009277704171836376, 0.006077939178794622, -0.001802294165827334, -0.0026645592879503965, 0.020165899768471718, -0.008869405835866928, 0.005436817184090614, -0.01217961497604847, 0.0041277483105659485, 0.0037694484926760197, 0.012205865234136581, -0.007016283925622702, -0.0073426589369773865, 0.011620745994150639, 0.021042924374341965, 0.0030969646759331226, -0.015324952080845833, -0.024322962388396263, 0.024117248132824898, -0.019822217524051666, -0.0037801736034452915, 0.010289791040122509, -0.010980784893035889, 0.0044779423624277115, 0.014004925265908241, 0.019946355372667313, 0.03970867767930031, -0.009570994414389133, 0.018718820065259933, 0.003422581357881427, 0.011862843297421932, 0.0067397537641227245, 0.004883458372205496, 0.012219471856951714, -0.009116094559431076, -0.0013050447450950742, 0.00534023204818368, -0.011427948251366615, 0.014851207844913006, 0.006204990204423666, -0.002804064890369773, 0.026376327499747276, 0.0019016448641195893, 0.013143667951226234, 0.029315216466784477, 0.003389348043128848, -0.008604390546679497, -0.004983706399798393, 0.0030650459229946136, 0.015514485538005829]

    # relu projector 92.39 100
    honest_cos = [0.0, 0.0, 0.9639042615890503, 0.9662392735481262, 0.9567713737487793, 0.9524208307266235, 0.9416282773017883, 0.9483412504196167, 0.943210780620575, 0.9461885690689087, 0.9450855851173401, 0.960116982460022, 0.9472572207450867, 0.9472651481628418, 0.9603810906410217, 0.9408425092697144, 0.9508052468299866, 0.9290726184844971, 0.9604672193527222, 0.9461397528648376, 0.9497254490852356, 0.9543728828430176, 0.9610199928283691, 0.9464420676231384, 0.9578455686569214, 0.94610196352005, 0.9512367844581604, 0.9621336460113525, 0.9617197513580322, 0.934604823589325, 0.9357197880744934, 0.9366987347602844, 0.95329749584198, 0.9421805143356323, 0.9380295276641846, 0.9302615523338318, 0.9420946836471558, 0.9449948668479919, 0.9547874927520752, 0.936937153339386, 0.9424702525138855, 0.9337054491043091, 0.9500871896743774, 0.9414237141609192, 0.9511255025863647, 0.9489641785621643, 0.9529187679290771, 0.9434875249862671, 0.9540057182312012, 0.9333503842353821, 0.9268071055412292, 0.9467089176177979, 0.9464713335037231, 0.9291402101516724, 0.9412490129470825, 0.9367044568061829, 0.9418014883995056, 0.9514859318733215, 0.9198211431503296, 0.9490529298782349, 0.9433630108833313, 0.9458458423614502, 0.9461986422538757, 0.9267102479934692, 0.968626081943512, 0.9203282594680786, 0.9360812306404114, 0.9325357675552368, 0.9593296051025391, 0.9490053653717041, 0.9390115737915039, 0.9446620345115662, 0.9413079619407654, 0.9462480545043945, 0.9406799674034119, 0.9465041756629944, 0.9530912041664124, 0.9053769707679749, 0.9342595338821411, 0.9413069486618042, 0.952247142791748, 0.9405201077461243, 0.9332696795463562, 0.9427272081375122, 0.9470311999320984, 0.9505864977836609, 0.9564235210418701, 0.9358855485916138, 0.9519342184066772, 0.9250528216362, 0.9567843675613403, 0.9525594115257263, 0.9375730156898499, 0.9487383961677551, 0.9639605283737183, 0.9239777326583862, 0.9376670718193054, 0.9309433102607727, 0.952885091304779, 0.9176015257835388]
    malicious_cos = [0.0, 0.0, 0.3443019390106201, 0.32847923040390015, 0.34697309136390686, 0.31809303164482117, 0.30832725763320923, 0.3404155373573303, 0.3439478576183319, 0.35122254490852356, 0.2983233332633972, 0.32306596636772156, 0.34443747997283936, 0.33101212978363037, 0.35138875246047974, 0.3319631814956665, 0.35747888684272766, 0.3613756597042084, 0.3512575328350067, 0.3171026408672333, 0.30187201499938965, 0.3410477340221405, 0.35634949803352356, 0.32965290546417236, 0.2991304099559784, 0.3784925043582916, 0.3497146964073181, 0.34422796964645386, 0.3134649991989136, 0.32820260524749756, 0.275639146566391, 0.30244991183280945, 0.3498345613479614, 0.3664267361164093, 0.3184623122215271, 0.34185001254081726, 0.34317585825920105, 0.3158751130104065, 0.32668542861938477, 0.3455769717693329, 0.3360968828201294, 0.3133898675441742, 0.3302769362926483, 0.32178065180778503, 0.3196556270122528, 0.3692110776901245, 0.35261961817741394, 0.3229388892650604, 0.34987974166870117, 0.304593563079834, 0.37971988320350647, 0.34953731298446655, 0.3625580370426178, 0.30986031889915466, 0.3274107873439789, 0.2967816889286041, 0.3300013840198517, 0.3075176179409027, 0.3276151418685913, 0.292587012052536, 0.31994807720184326, 0.3381650149822235, 0.33874064683914185, 0.3219570815563202, 0.3119072914123535, 0.30246686935424805, 0.3342038691043854, 0.36253657937049866, 0.29417845606803894, 0.3329189419746399, 0.31901463866233826, 0.344969242811203, 0.35711243748664856, 0.28562575578689575, 0.3713349997997284, 0.32473960518836975, 0.3210606276988983, 0.318793386220932, 0.323749840259552, 0.32971566915512085, 0.3437900245189667, 0.2969573140144348, 0.3219728469848633, 0.2944572865962982, 0.34790316224098206, 0.3479553461074829, 0.3414830267429352, 0.3554876744747162, 0.3429108262062073, 0.3208285868167877, 0.3435448408126831, 0.3311316668987274, 0.35282766819000244, 0.3298720419406891, 0.3257100582122803, 0.35991737246513367, 0.3473031520843506, 0.36035385727882385, 0.3037973642349243, 0.3139903247356415]

    # sigmoid projector 92.37 100
    honest_cos = [0.0, 0.0, 0.9979341626167297, 0.9996411800384521, 0.9996373653411865, 0.9995887875556946, 0.9967842698097229, 0.9980801939964294, 0.999553918838501, 0.9988439679145813, 0.9967241287231445, 0.9997430443763733, 0.994708240032196, 0.998959481716156, 0.9976526498794556, 0.9993231892585754, 0.9982056617736816, 0.9988425374031067, 0.9987856149673462, 0.9998763203620911, 0.9998269081115723, 0.9997967481613159, 0.9996743202209473, 0.9974191188812256, 0.9998483061790466, 0.9987677931785583, 0.998979926109314, 0.9998464584350586, 0.9987560510635376, 0.9964436888694763, 0.9990448355674744, 0.9996866583824158, 0.9998071789741516, 0.99922776222229, 0.9997683763504028, 0.997164785861969, 0.9973021149635315, 0.9991641640663147, 0.9983410835266113, 0.9993858337402344, 0.9993470311164856, 0.9988997578620911, 0.9997421503067017, 0.9988529086112976, 0.9998216032981873, 0.9991979598999023, 0.9991269111633301, 0.9983916878700256, 0.9982231855392456, 0.9993465542793274, 0.9963424801826477, 0.9990361928939819, 0.9997434616088867, 0.9962676167488098, 0.9969772696495056, 0.9988802671432495, 0.9959419965744019, 0.9989967942237854, 0.9962317943572998, 0.9998515248298645, 0.9990438222885132, 0.9984269142150879, 0.9989660978317261, 0.9962062835693359, 0.9998296499252319, 0.9987695813179016, 0.9983007907867432, 0.9988127946853638, 0.9998664259910583, 0.9995569586753845, 0.9977748990058899, 0.9980607628822327, 0.9981980919837952, 0.99989253282547, 0.9985619783401489, 0.9996643662452698, 0.9998630285263062, 0.9954582452774048, 0.9991036057472229, 0.9987332820892334, 0.9994098544120789, 0.9984439015388489, 0.9993506669998169, 0.998757541179657, 0.9979383945465088, 0.9993125200271606, 0.999589741230011, 0.9990509748458862, 0.9993184208869934, 0.9991820454597473, 0.9986089468002319, 0.9999030232429504, 0.997750461101532, 0.9984896183013916, 0.9999242424964905, 0.998727023601532, 0.9972706437110901, 0.9989072680473328, 0.9988393783569336, 0.9989872574806213]
    malicious_cos = [0.0, 0.0, 0.9619830250740051, 0.9648229479789734, 0.9652883410453796, 0.9673712849617004, 0.9652733206748962, 0.9657209515571594, 0.9642149806022644, 0.9655590057373047, 0.9650516510009766, 0.9639601707458496, 0.9655812382698059, 0.9651603102684021, 0.965095043182373, 0.9658412337303162, 0.9623538255691528, 0.9657015800476074, 0.9659391641616821, 0.9647964835166931, 0.9658617973327637, 0.9652865529060364, 0.9638926386833191, 0.9662247896194458, 0.9641047716140747, 0.9654900431632996, 0.9628890156745911, 0.9649573564529419, 0.9638075232505798, 0.9654504060745239, 0.9644858241081238, 0.9662767648696899, 0.9640159010887146, 0.965815544128418, 0.9673771858215332, 0.9669626355171204, 0.9656813740730286, 0.9652002453804016, 0.963909924030304, 0.9655505418777466, 0.9659391641616821, 0.9660892486572266, 0.9628403782844543, 0.9647880792617798, 0.9629775285720825, 0.9665291905403137, 0.9647661447525024, 0.9660631418228149, 0.96490877866745, 0.9661960005760193, 0.9661127328872681, 0.9659151434898376, 0.9646069407463074, 0.9650708436965942, 0.9658963084220886, 0.9630467295646667, 0.9653177261352539, 0.9663745164871216, 0.9665461778640747, 0.9653543829917908, 0.9641362428665161, 0.9638967514038086, 0.9650965929031372, 0.9664603471755981, 0.9621523022651672, 0.9663946032524109, 0.965763509273529, 0.9659758806228638, 0.9626156091690063, 0.9644758105278015, 0.9662929773330688, 0.9645674824714661, 0.9652225375175476, 0.9658692479133606, 0.9644888043403625, 0.9643110632896423, 0.9634499549865723, 0.9658600091934204, 0.9651404619216919, 0.9658198356628418, 0.965399444103241, 0.963692843914032, 0.9643699526786804, 0.962874710559845, 0.9652536511421204, 0.9656699299812317, 0.9649128913879395, 0.9667527079582214, 0.9660646319389343, 0.9641607403755188, 0.9642714858055115, 0.9664576649665833, 0.9608017802238464, 0.9612467885017395, 0.9642449617385864, 0.9641808867454529, 0.9639615416526794, 0.96552574634552, 0.9626412391662598, 0.9673271179199219]

    # tanh projector 92.77 100
    honest_cos = [0.0, 0.0, 0.9763443470001221, 0.971447765827179, 0.9727466106414795, 0.9657229781150818, 0.9653180837631226, 0.9633681774139404, 0.9775153398513794, 0.9593972563743591, 0.9774135947227478, 0.9781089425086975, 0.9616543054580688, 0.9728594422340393, 0.9697750210762024, 0.9626791477203369, 0.9713788628578186, 0.9580671787261963, 0.9735407829284668, 0.9726985692977905, 0.9766876101493835, 0.9697917103767395, 0.9703953862190247, 0.9671270847320557, 0.9707002639770508, 0.9578725099563599, 0.9657280445098877, 0.9703024625778198, 0.964050829410553, 0.9603740572929382, 0.9639582633972168, 0.9597525000572205, 0.9706299304962158, 0.9558063745498657, 0.9646411538124084, 0.9381766319274902, 0.9518210291862488, 0.9593917727470398, 0.9562535881996155, 0.9600152373313904, 0.9585694670677185, 0.946500301361084, 0.9572831988334656, 0.9562664031982422, 0.9628303050994873, 0.9417867064476013, 0.9638190269470215, 0.9449306130409241, 0.9646705985069275, 0.960514485836029, 0.9525596499443054, 0.9375346899032593, 0.9607197046279907, 0.951752781867981, 0.9497541785240173, 0.9567399024963379, 0.9527942538261414, 0.9648337960243225, 0.9450351595878601, 0.9634373784065247, 0.9528569579124451, 0.9453722834587097, 0.9518994688987732, 0.9408567547798157, 0.9741254448890686, 0.9497313499450684, 0.9471477270126343, 0.9489014148712158, 0.9646871089935303, 0.9582484364509583, 0.9509173035621643, 0.9476329684257507, 0.9366353154182434, 0.968411922454834, 0.944875955581665, 0.9594905376434326, 0.9650545120239258, 0.9426236748695374, 0.9545153379440308, 0.9516070485115051, 0.9575850963592529, 0.9475070238113403, 0.9510239362716675, 0.9543485641479492, 0.9468399286270142, 0.9573284387588501, 0.9638897180557251, 0.9543906450271606, 0.9533012509346008, 0.9436212182044983, 0.964397668838501, 0.958585262298584, 0.9536502957344055, 0.9594830274581909, 0.9732905626296997, 0.955246090888977, 0.951761782169342, 0.9446061849594116, 0.9637275338172913, 0.9451255202293396]
    malicious_cos = [0.0, 0.0, 0.0041657364927232265, -0.006621640175580978, 0.016032330691814423, -0.010293509811162949, -0.014583321288228035, -0.013477079570293427, -0.0007520154467783868, 0.016142776235938072, 0.02714449167251587, 0.017542047426104546, 0.04354597255587578, 0.013262097723782063, 0.024208545684814453, -0.01329744141548872, 0.023780353367328644, 0.023346111178398132, 0.020921921357512474, 0.001198197714984417, 0.024102842435240746, 0.00532281119376421, -0.006743584759533405, 0.0025877119041979313, 0.02541979029774666, -0.010319726541638374, 0.017628319561481476, 0.023071259260177612, -0.006298545282334089, 0.003705432405695319, -0.019940337166190147, 0.010660278610885143, 0.010938356630504131, 0.004712905269116163, 0.0020019474904984236, 0.011751936748623848, -0.0036948123015463352, 0.022614074870944023, 0.0195977371186018, 0.015632998198270798, 0.01262719091027975, 0.020252475515007973, -0.007642695214599371, 0.01599252223968506, 0.019921913743019104, 0.007378093432635069, 0.008632618002593517, -0.012003096751868725, 0.0022950030397623777, 0.009747577831149101, 0.0007013205322436988, 0.03798706457018852, 0.024065466597676277, 0.010403870604932308, 0.009362592361867428, 0.031217217445373535, 0.028620785102248192, 0.01344902254641056, -0.0223703533411026, 0.013726482167840004, 0.0013819586019963026, 0.003187101101502776, 0.005938764661550522, 0.0030730152502655983, 0.015482306480407715, -0.008448466658592224, -0.0026257650461047888, 0.007221032865345478, -0.018197527155280113, -0.013002792373299599, -0.003282931400462985, -5.457606312120333e-05, 0.015501960180699825, -0.0028098509646952152, -0.006421852391213179, -0.0035388150718063116, 0.013978540897369385, 0.0014103158609941602, -0.0014878446236252785, 0.01539760734885931, -0.0009662151569500566, 0.013942989520728588, 0.0008854845655150712, -0.020292075350880623, 0.008718212135136127, 0.024844391271471977, -0.00844139140099287, -0.0070267184637486935, 0.0015195253072306514, 0.023145711049437523, 0.02191542088985443, 0.0251633133739233, -0.0012623639777302742, 0.016064751893281937, 0.005003859288990498, 0.017083365470170975, -0.00034040436730720103, 0.00280018406920135, -0.0034355975221842527, 0.01466391235589981]


    plt.plot(x, honest_cos, '*-', markersize=0, linewidth=3, c='#2dabb2', label='honest', alpha=1)
    plt.plot(x, malicious_cos, 'o-', markersize=0, linewidth=3, c='#daab36', label='malicious', alpha=1)
    plt.legend(fontsize=30)

    plt.show()
    fig.savefig('/home/ln/JinBo/code/Against-Large-Scale-Poison/result/response1_7.pdf', bbox_inches='tight')


if __name__ == '__main__':
    response1_4()