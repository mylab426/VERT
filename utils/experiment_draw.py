import numpy as np
import torch
from matplotlib import pyplot as plt
import matplotlib
from sklearn.manifold import TSNE
import pandas as pd
import seaborn as sns
matplotlib.use('TkAgg')


def experiment1_1():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Cosine Similarity", fontdict={'size': 30})
    plt.xticks(np.arange(0, 201, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 200)

    # x = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200]
    x = []
    for i in range(3, 201):
        x.append(i)

    honest_sim = [0.9994901418685913, 0.9999983906745911, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

    malicious_sim = [0.8609740734100342, 0.8583766222000122, 0.8710318207740784, 0.869885265827179, 0.8717972040176392, 0.863783597946167, 0.8601018786430359, 0.8618231415748596, 0.8546541333198547, 0.8616755604743958, 0.8661078214645386, 0.8636205792427063, 0.8641991019248962, 0.8659452795982361, 0.866879403591156, 0.8721491098403931, 0.8662012815475464, 0.868472158908844, 0.8739741444587708, 0.8597456812858582, 0.8694014549255371, 0.8793678283691406, 0.8629935383796692, 0.860180139541626, 0.8732244968414307, 0.8621299862861633, 0.8593114614486694, 0.8725347518920898, 0.8666796684265137, 0.8629449605941772, 0.8690734505653381, 0.8655508756637573, 0.8732171654701233, 0.8580365777015686, 0.8682587146759033, 0.861746072769165, 0.8615560531616211, 0.8712120056152344, 0.8705772161483765, 0.8660078048706055, 0.8749977946281433, 0.8661197423934937, 0.8707056045532227, 0.8673408627510071, 0.8619095683097839, 0.868740975856781, 0.873378574848175, 0.8591235280036926, 0.8729685544967651, 0.8670282959938049, 0.8657485842704773, 0.8609346747398376, 0.8604702949523926, 0.864120364189148, 0.8567230701446533, 0.8710412383079529, 0.8710520267486572, 0.8589291572570801, 0.8648360967636108, 0.8737033009529114, 0.8583862781524658, 0.8595439195632935, 0.8631644248962402, 0.8589008450508118, 0.8704325556755066, 0.8555641174316406, 0.8579334020614624, 0.8726880550384521, 0.8693583607673645, 0.8498309254646301, 0.8623882532119751, 0.8727538585662842, 0.8697479367256165, 0.8716332316398621, 0.866910457611084, 0.8756386637687683, 0.8568358421325684, 0.8668286800384521, 0.8705670237541199, 0.8663185238838196, 0.8588719367980957, 0.853844940662384, 0.8715539574623108, 0.864892840385437, 0.8747884631156921, 0.8616591691970825, 0.8591083884239197, 0.8738702535629272, 0.856941819190979, 0.8706551790237427, 0.8613783717155457, 0.8736319541931152, 0.8659384250640869, 0.8624250292778015, 0.8699327707290649, 0.869313657283783, 0.870159387588501, 0.8642046451568604, 0.8790661692619324, 0.8694590330123901, 0.8557760715484619, 0.8621285557746887, 0.8639425039291382, 0.8522377610206604, 0.8677662014961243, 0.8762124180793762, 0.8701687455177307, 0.8684867024421692, 0.8558159470558167, 0.8637282848358154, 0.8682476878166199, 0.8705728054046631, 0.8719381093978882, 0.8665739297866821, 0.8550673127174377, 0.8602036237716675, 0.867433488368988, 0.8615020513534546, 0.8629606366157532, 0.8659191727638245, 0.867296576499939, 0.8672714233398438, 0.8689048886299133, 0.8599678874015808, 0.8629383444786072, 0.8531677722930908, 0.8678088188171387, 0.850890576839447, 0.858094334602356, 0.8694818019866943, 0.872093915939331, 0.852107584476471, 0.8632864952087402, 0.859403669834137, 0.8703228235244751, 0.8682131171226501, 0.8670017123222351, 0.8659350872039795, 0.8665090799331665, 0.8611435294151306, 0.869268000125885, 0.8727225661277771, 0.8669246435165405, 0.869134783744812, 0.8708699941635132, 0.8615712523460388, 0.8498260974884033, 0.8718559741973877, 0.8686491250991821, 0.8707072138786316, 0.8534753918647766, 0.8736134171485901, 0.8613720536231995, 0.8666843771934509, 0.869347333908081, 0.857026994228363, 0.86048823595047, 0.8606061935424805, 0.8573420643806458, 0.8693024516105652, 0.8665374517440796, 0.8675914406776428, 0.8672342896461487, 0.855724573135376, 0.8701004981994629, 0.8653349876403809, 0.8686322569847107, 0.867513120174408, 0.850454568862915, 0.8563747406005859, 0.8703482747077942, 0.8717430233955383, 0.868230402469635, 0.8776153922080994, 0.8706691265106201, 0.8604997992515564, 0.8681725263595581, 0.8638491630554199, 0.8596644997596741, 0.859525203704834, 0.8726997375488281, 0.8629130721092224, 0.8585891723632812, 0.8622511625289917, 0.8648683428764343, 0.8675879836082458, 0.868934154510498, 0.8587332963943481, 0.8635975122451782, 0.8588138222694397, 0.8707121014595032, 0.8662351369857788, 0.8593656420707703, 0.8631634712219238, 0.858830988407135, 0.8710890412330627, 0.8599490523338318, 0.864112377166748]

    top_k_sim = [0.9996160864830017, 0.9999991655349731, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9926334023475647, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]


    plt.plot(x, honest_sim, 's-', markersize=0, linewidth=5, c='#2dabb2', label='Honest', alpha=1)
    plt.plot(x, malicious_sim, 'o-', markersize=0, linewidth=5, c='#daab36', label='Compromised', alpha=1)
    plt.plot(x, top_k_sim, 'p-', markersize=0, linewidth=2, c='#f0552b', label='Top-K', alpha=1)
    plt.legend(fontsize=30)

    plt.show()
    fig.savefig('./result/experiment1_1.pdf', bbox_inches='tight')


def experiment1_2():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Cosine Similarity", fontdict={'size': 30})
    plt.xticks(np.arange(0, 201, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 200)

    x = []
    for i in range(3, 201):
        x.append(i)

    honest_sim = [0.9990715384483337, 0.9999918341636658, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

    malicious_sim = [0.8641383647918701, 0.8675282597541809, 0.8642900586128235, 0.8631575703620911, 0.8667890429496765, 0.8614615797996521, 0.8695204854011536, 0.857264518737793, 0.8731738924980164, 0.8696863651275635, 0.8652699589729309, 0.8647411465644836, 0.873187243938446, 0.8749266862869263, 0.8541808724403381, 0.8705927729606628, 0.8726114630699158, 0.8595707416534424, 0.8586300611495972, 0.8632859587669373, 0.8670103549957275, 0.8551800847053528, 0.8611196875572205, 0.868773877620697, 0.8640525341033936, 0.865425705909729, 0.8635881543159485, 0.864870011806488, 0.8780531287193298, 0.867850124835968, 0.8566301465034485, 0.8630713224411011, 0.8603317141532898, 0.8682633638381958, 0.875481903553009, 0.8661330342292786, 0.8719118237495422, 0.8612342476844788, 0.8595044016838074, 0.8655730485916138, 0.8635936975479126, 0.8670834302902222, 0.8648124933242798, 0.8634495735168457, 0.8690463304519653, 0.8580783605575562, 0.8594138026237488, 0.8669964671134949, 0.8614547848701477, 0.856935977935791, 0.8618528246879578, 0.8681372404098511, 0.8614160418510437, 0.8578681349754333, 0.8562170267105103, 0.8505463004112244, 0.8575484752655029, 0.856691300868988, 0.8728248476982117, 0.8682740926742554, 0.8587627410888672, 0.8604665994644165, 0.877245306968689, 0.8720915913581848, 0.8706796169281006, 0.8616315722465515, 0.8676983714103699, 0.8771491050720215, 0.8707419633865356, 0.8691872358322144, 0.8606562614440918, 0.8766037225723267, 0.8776925802230835, 0.8694963455200195, 0.861502468585968, 0.8654507994651794, 0.8753216862678528, 0.8589990139007568, 0.8710377216339111, 0.8674139380455017, 0.8680716753005981, 0.8614579439163208, 0.8630993962287903, 0.8639950156211853, 0.8594129681587219, 0.8624935746192932, 0.8594930171966553, 0.8702479004859924, 0.8657456636428833, 0.870657742023468, 0.8611940741539001, 0.8716980814933777, 0.8723019361495972, 0.8642573356628418, 0.8597742915153503, 0.8684714436531067, 0.8618531227111816, 0.8607475161552429, 0.865094780921936, 0.8566372394561768, 0.8643029928207397, 0.8663854002952576, 0.8647152781486511, 0.8618524670600891, 0.8661366701126099, 0.8590056300163269, 0.8606500625610352, 0.869786262512207, 0.8513728976249695, 0.8641089797019958, 0.8652398586273193, 0.8622168898582458, 0.867863118648529, 0.8705703616142273, 0.8548526763916016, 0.8606321215629578, 0.8687039613723755, 0.8773808479309082, 0.8540849685668945, 0.8544418215751648, 0.862585723400116, 0.863468587398529, 0.8695929646492004, 0.8589199185371399, 0.8653231263160706, 0.866130530834198, 0.859982430934906, 0.8688883185386658, 0.866546094417572, 0.861689031124115, 0.8617088198661804, 0.8588053584098816, 0.8722095489501953, 0.8703464269638062, 0.8694191575050354, 0.8771476149559021, 0.8621120452880859, 0.8605924844741821, 0.8586574792861938, 0.8579484224319458, 0.8679206967353821, 0.8642597198486328, 0.8636636137962341, 0.8654043078422546, 0.8642846941947937, 0.8554508686065674, 0.8711737990379333, 0.8724942207336426, 0.865691602230072, 0.8642182350158691, 0.863680362701416, 0.8592765927314758, 0.8704406023025513, 0.86556476354599, 0.8560424447059631, 0.8634616136550903, 0.8586617708206177, 0.871084988117218, 0.8617271184921265, 0.8544162511825562, 0.8532217741012573, 0.8573940396308899, 0.8739469647407532, 0.8652135729789734, 0.8681020140647888, 0.8645647764205933, 0.8646668791770935, 0.8681206107139587, 0.8557424545288086, 0.866163969039917, 0.8653518557548523, 0.8640497922897339, 0.8693583607673645, 0.8626446723937988, 0.855741560459137, 0.8620407581329346, 0.8692893385887146, 0.8702371716499329, 0.8683916330337524, 0.859706699848175, 0.8582040667533875, 0.8601833581924438, 0.8551684617996216, 0.8720696568489075, 0.8556675910949707, 0.8653085231781006, 0.8564266562461853, 0.8647785186767578, 0.8731414079666138, 0.8760181069374084, 0.865045428276062, 0.8707816004753113, 0.8597535490989685, 0.8556599020957947, 0.8677257895469666, 0.8831157088279724, 0.8701046109199524, 0.8686611652374268]

    top_k_sim = [0.9996596574783325, 0.9999995231628418, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0]


    plt.plot(x, honest_sim, 's-', markersize=0, linewidth=5, c='#2dabb2', label='Honest', alpha=1)
    plt.plot(x, malicious_sim, 'o-', markersize=0, linewidth=5, c='#daab36', label='Compromised', alpha=1)
    plt.plot(x, top_k_sim, 'p-', markersize=0, linewidth=2, c='#f0552b', label='Top-K', alpha=1)

    plt.show()
    fig.savefig('./result/experiment1_2.pdf', bbox_inches='tight')

def experiment1_3():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Cosine Similarity", fontdict={'size': 30})
    plt.xticks(np.arange(0, 201, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 200)

    x = []
    for i in range(3, 201):
        x.append(i)

    honest_sim = [0.9997063875198364, 0.9999988079071045, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

    malicious_sim = [0.8582321405410767, 0.8577436208724976, 0.8623806834220886, 0.8756818175315857, 0.8473554849624634, 0.8638006448745728, 0.8597287535667419, 0.8508172035217285, 0.8628662824630737, 0.8598762154579163, 0.8655840754508972, 0.8556239008903503, 0.8628178834915161, 0.8665034770965576, 0.8775679469108582, 0.8558008074760437, 0.8626393675804138, 0.8664834499359131, 0.8700457215309143, 0.8610854744911194, 0.8614519834518433, 0.8711815476417542, 0.863162100315094, 0.8651862740516663, 0.869210958480835, 0.8574879765510559, 0.8678421378135681, 0.8701748251914978, 0.8644257187843323, 0.8589958548545837, 0.8765549659729004, 0.8684115409851074, 0.8599209189414978, 0.8604500889778137, 0.8509494066238403, 0.866733968257904, 0.8540620803833008, 0.8581228256225586, 0.8641425967216492, 0.8643448948860168, 0.8550180196762085, 0.8627615571022034, 0.8606814742088318, 0.8680947422981262, 0.8596575260162354, 0.8618398308753967, 0.8667441606521606, 0.8541371822357178, 0.8601410984992981, 0.8727957010269165, 0.8630571961402893, 0.8582533597946167, 0.864922285079956, 0.8674494624137878, 0.8642768263816833, 0.8629646897315979, 0.8654425740242004, 0.8643400073051453, 0.8589550256729126, 0.872802734375, 0.8614803552627563, 0.8654776811599731, 0.8648684024810791, 0.8599485158920288, 0.8635697364807129, 0.8543840646743774, 0.863010585308075, 0.8629082441329956, 0.8612689971923828, 0.860663890838623, 0.8618052005767822, 0.8604371547698975, 0.8599159717559814, 0.8620113134384155, 0.8636027574539185, 0.8587138652801514, 0.8589204549789429, 0.8699699640274048, 0.8560664653778076, 0.8658381700515747, 0.8682792782783508, 0.8559249639511108, 0.8616082668304443, 0.8656559586524963, 0.8626320362091064, 0.8672119379043579, 0.878709077835083, 0.8770840764045715, 0.8579302430152893, 0.8498069047927856, 0.871802806854248, 0.8630825877189636, 0.8579487800598145, 0.8679553270339966, 0.8735349178314209, 0.8490264415740967, 0.8650520443916321, 0.8633800148963928, 0.8671582341194153, 0.8582682609558105, 0.8580179214477539, 0.863767147064209, 0.8644307851791382, 0.8618120551109314, 0.8708533048629761, 0.8616706132888794, 0.8537887334823608, 0.8585395812988281, 0.8653002977371216, 0.8762692213058472, 0.8600175380706787, 0.8677085041999817, 0.856661856174469, 0.8621882200241089, 0.849096417427063, 0.8540290594100952, 0.8475477695465088, 0.8700908422470093, 0.8676122426986694, 0.8674289584159851, 0.8685891032218933, 0.8709465861320496, 0.8609818816184998, 0.863759458065033, 0.8628103733062744, 0.8632391095161438, 0.8584388494491577, 0.8554613590240479, 0.861931562423706, 0.8613713979721069, 0.8638612627983093, 0.8636777997016907, 0.8521889448165894, 0.8641334176063538, 0.8652717471122742, 0.8739098906517029, 0.868146538734436, 0.8699714541435242, 0.8679197430610657, 0.8665989637374878, 0.8704259991645813, 0.8734493255615234, 0.8734095692634583, 0.8743762969970703, 0.8666250705718994, 0.8583505153656006, 0.8549323678016663, 0.8607429265975952, 0.8623066544532776, 0.8607815504074097, 0.8794527649879456, 0.8630175590515137, 0.8648963570594788, 0.8719373345375061, 0.8731659054756165, 0.8633986711502075, 0.8626771569252014, 0.8559952974319458, 0.8569470047950745, 0.8739365935325623, 0.862764298915863, 0.868446946144104, 0.8682354092597961, 0.8714455962181091, 0.8616377115249634, 0.8566613793373108, 0.852837860584259, 0.8661381006240845, 0.8562309741973877, 0.8703432679176331, 0.8632188439369202, 0.8642414212226868, 0.8585850596427917, 0.8654893636703491, 0.8618879318237305, 0.864971399307251, 0.8558934926986694, 0.8704031109809875, 0.8615885376930237, 0.8656100630760193, 0.8547478914260864, 0.8719202280044556, 0.8684180378913879, 0.8665810823440552, 0.8643008470535278, 0.8660784959793091, 0.8661743402481079, 0.8519020676612854, 0.8719457983970642, 0.8732519149780273, 0.8672869205474854, 0.8618364334106445, 0.8677893877029419, 0.8635346293449402, 0.8595278263092041, 0.8766235709190369, 0.8604999780654907, 0.8592195510864258]

    top_k_sim = [0.9998055696487427, 0.9999995827674866, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0000001192092896, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0000001192092896, 1.0]


    plt.plot(x, honest_sim, 's-', markersize=0, linewidth=5, c='#2dabb2', label='Honest', alpha=1)
    plt.plot(x, malicious_sim, 'o-', markersize=0, linewidth=5, c='#daab36', label='Compromised', alpha=1)
    plt.plot(x, top_k_sim, 'p-', markersize=0, linewidth=2, c='#f0552b', label='Top-K', alpha=1)

    plt.show()
    fig.savefig('./result/experiment1_3.pdf', bbox_inches='tight')

def experiment1_4():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Cosine Similarity", fontdict={'size': 30})
    plt.xticks(np.arange(0, 201, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 200)

    x = []
    for i in range(3, 201):
        x.append(i)

    honest_sim = [0.9994720816612244, 0.9999993443489075, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0]

    malicious_sim = [0.8759145736694336, 0.8584755063056946, 0.8683709502220154, 0.8702507019042969, 0.8674468994140625, 0.8605728149414062, 0.8614818453788757, 0.8559784293174744, 0.8762535452842712, 0.8641049265861511, 0.855617105960846, 0.8655705451965332, 0.8670989871025085, 0.8496034145355225, 0.862313449382782, 0.8687167167663574, 0.857578694820404, 0.8649765253067017, 0.8588973879814148, 0.8635973930358887, 0.8704496622085571, 0.863991916179657, 0.8598936200141907, 0.8649622201919556, 0.8610479235649109, 0.8634085059165955, 0.8709399104118347, 0.8637806177139282, 0.8626601099967957, 0.861568808555603, 0.8655902147293091, 0.8671633005142212, 0.8647465109825134, 0.8586103916168213, 0.8585367202758789, 0.8637263774871826, 0.858325183391571, 0.863503634929657, 0.8650654554367065, 0.8629303574562073, 0.8632119297981262, 0.8558063507080078, 0.8659948706626892, 0.8684671521186829, 0.8638749122619629, 0.872704803943634, 0.8573499321937561, 0.8688488006591797, 0.860442578792572, 0.8671011924743652, 0.8704659938812256, 0.8662252426147461, 0.8769546747207642, 0.8636817336082458, 0.8718196153640747, 0.8591055274009705, 0.8630810976028442, 0.8581830263137817, 0.8688603043556213, 0.8578785061836243, 0.8554299473762512, 0.8614600300788879, 0.8654447197914124, 0.8520105481147766, 0.8692941069602966, 0.8675164580345154, 0.8682937026023865, 0.8737296462059021, 0.8683329224586487, 0.8599853515625, 0.8630632162094116, 0.8650137782096863, 0.868831992149353, 0.8678733706474304, 0.8686414957046509, 0.8568601012229919, 0.8648305535316467, 0.8629117012023926, 0.8623769283294678, 0.8683744668960571, 0.858899712562561, 0.8662816882133484, 0.8678240776062012, 0.8580080270767212, 0.8611406683921814, 0.8507490158081055, 0.8600848913192749, 0.8676511645317078, 0.8544886708259583, 0.8585804104804993, 0.8679109811782837, 0.859950065612793, 0.8646178245544434, 0.8669160008430481, 0.8719667196273804, 0.8613319993019104, 0.8633849620819092, 0.8638541102409363, 0.8662992119789124, 0.8624212145805359, 0.8693439364433289, 0.8663532137870789, 0.8606209754943848, 0.8586546778678894, 0.8591976761817932, 0.858658492565155, 0.8645686507225037, 0.863386332988739, 0.8704965710639954, 0.8550329208374023, 0.8671085238456726, 0.8650160431861877, 0.8587223887443542, 0.8663307428359985, 0.8584409356117249, 0.8661661148071289, 0.8650094270706177, 0.864506185054779, 0.8544317483901978, 0.8638851046562195, 0.872570812702179, 0.8631357550621033, 0.8628323674201965, 0.8669564127922058, 0.8655010461807251, 0.8649184703826904, 0.8613579869270325, 0.8665788769721985, 0.861283004283905, 0.8618456125259399, 0.8667782545089722, 0.8747008442878723, 0.8654069900512695, 0.8643699288368225, 0.8606742024421692, 0.8644750118255615, 0.8685533404350281, 0.8738771677017212, 0.8601780533790588, 0.8604060411453247, 0.8716505169868469, 0.8667359352111816, 0.8670344352722168, 0.8622881770133972, 0.8555547595024109, 0.8682999610900879, 0.8588867783546448, 0.8671522736549377, 0.8646811246871948, 0.8597508072853088, 0.8687151074409485, 0.865909993648529, 0.8599159121513367, 0.8642498850822449, 0.8577166199684143, 0.8637008666992188, 0.8651950359344482, 0.8594749569892883, 0.8699886202812195, 0.8747058510780334, 0.8633458018302917, 0.8601104617118835, 0.8656614422798157, 0.8680535554885864, 0.8610316514968872, 0.8682880401611328, 0.8601340651512146, 0.8688076138496399, 0.865909993648529, 0.8783518671989441, 0.8628705143928528, 0.8626143336296082, 0.8604955077171326, 0.858586847782135, 0.8582082986831665, 0.8690229654312134, 0.8626187443733215, 0.8573867082595825, 0.8619053959846497, 0.8676884770393372, 0.8639810681343079, 0.8672706484794617, 0.8656517267227173, 0.860097348690033, 0.878812313079834, 0.8734962344169617, 0.869362473487854, 0.8636464476585388, 0.8595739603042603, 0.8719028234481812, 0.8647387623786926, 0.8655943274497986, 0.8547934889793396, 0.868829071521759, 0.8687987327575684, 0.8581940531730652, 0.8614852428436279, 0.8627661466598511]

    top_k_sim = [0.9996829032897949, 0.9999995827674866, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]


    plt.plot(x, honest_sim, 's-', markersize=0, linewidth=5, c='#2dabb2', label='Honest', alpha=1)
    plt.plot(x, malicious_sim, 'o-', markersize=0, linewidth=5, c='#daab36', label='Compromised', alpha=1)
    plt.plot(x, top_k_sim, 'p-', markersize=0, linewidth=2, c='#f0552b', label='Top-K', alpha=1)

    plt.show()
    fig.savefig('./result/experiment1_4.pdf', bbox_inches='tight')

def experiment1_5():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Cosine Similarity", fontdict={'size': 30})
    plt.xticks(np.arange(0, 201, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 200)

    x = []
    for i in range(3, 201):
        x.append(i)

    honest_sim = [0.896416425704956, 0.9997488260269165, 0.9997329711914062, 0.9996524453163147, 0.9996573328971863, 0.9996553063392639, 0.9996464848518372, 0.9996364712715149, 0.9996060132980347, 0.999601423740387, 0.9996287226676941, 0.9996114373207092, 0.9996132850646973, 0.9995911717414856, 0.9995797276496887, 0.9996248483657837, 0.9996156692504883, 0.9995855689048767, 0.9996122121810913, 0.9995635747909546, 0.9995979070663452, 0.9995970129966736, 0.9996046423912048, 0.9995831251144409, 0.9996167421340942, 0.9995863437652588, 0.9996144771575928, 0.9996274709701538, 0.999592661857605, 0.999618411064148, 0.9995740056037903, 0.9995939135551453, 0.9996094703674316, 0.99962317943573, 0.999634325504303, 0.9996436834335327, 0.9996315836906433, 0.999584972858429, 0.9996024966239929, 0.9996010065078735, 0.9996199607849121, 0.999573290348053, 0.9996036887168884, 0.9996168613433838, 0.9995899796485901, 0.9995886087417603, 0.9996070861816406, 0.9995993375778198, 0.9996281862258911, 0.9995847344398499, 0.9996268153190613, 0.9995880722999573, 0.9996150135993958, 0.9995729923248291, 0.9996196031570435, 0.9996055364608765, 0.9996223449707031, 0.9995946288108826, 0.9996251463890076, 0.9995845556259155, 0.9996103644371033, 0.9996050000190735, 0.9996511340141296, 0.9995923042297363, 0.9995916485786438, 0.9996386766433716, 0.9996185302734375, 0.9995951056480408, 0.999607503414154, 0.9995977282524109, 0.9996029734611511, 0.9995596408843994, 0.9996114373207092, 0.9995533227920532, 0.9995900988578796, 0.99961256980896, 0.9996292591094971, 0.8879875540733337, 0.9943692684173584, 0.9987837076187134, 0.9984811544418335, 0.998931348323822, 0.9991862773895264, 0.9992325901985168, 0.9990545511245728, 0.9984604120254517, 0.9988380074501038, 0.9989339113235474, 0.9988449811935425, 0.9989983439445496, 0.998999834060669, 0.9990173578262329, 0.9990062713623047, 0.998600959777832, 0.9985724091529846, 0.9988347291946411, 0.9988867044448853, 0.9990125298500061, 0.9984035491943359, 0.9987717866897583, 0.9989849925041199, 0.9986896514892578, 0.9988783597946167, 0.9989567399024963, 0.9990313649177551, 0.9989821910858154, 0.9992566108703613, 0.9989874362945557, 0.9988237023353577, 0.998828113079071, 0.9987486600875854, 0.9989393949508667, 0.9984579682350159, 0.9990825653076172, 0.9991190433502197, 0.9988781213760376, 0.9991873502731323, 0.9990665316581726, 0.9989137649536133, 0.9989517331123352, 0.9986473917961121, 0.9983822107315063, 0.9989549517631531, 0.9989498257637024, 0.9991106390953064, 0.9989075660705566, 0.9989204406738281, 0.9987571239471436, 0.9986334443092346, 0.9991437196731567, 0.9986913204193115, 0.9991886615753174, 0.9989979267120361, 0.9990569353103638, 0.9986462593078613, 0.99894118309021, 0.9987448453903198, 0.9988484382629395, 0.9989296793937683, 0.9990291595458984, 0.9992028474807739, 0.9990893602371216, 0.9990397691726685, 0.9986666440963745, 0.9982417225837708, 0.9986198544502258, 0.9986453652381897, 0.9978324770927429, 0.9988721609115601, 0.9988264441490173, 0.9983236789703369, 0.9988318085670471, 0.998958170413971, 0.9991120100021362, 0.9982221126556396, 0.9983990788459778, 0.998494029045105, 0.9991059303283691, 0.9989134669303894, 0.9991509914398193, 0.9987604022026062, 0.9990454912185669, 0.9990638494491577, 0.9991165399551392, 0.9988914132118225, 0.9988828897476196, 0.998672366142273, 0.9986494183540344, 0.9983861446380615, 0.999232292175293, 0.9990742802619934, 0.9991478323936462, 0.9988917112350464, 0.9990838766098022, 0.9990836977958679, 0.9989819526672363, 0.999262273311615, 0.9988768100738525, 0.9991540312767029, 0.9989109039306641, 0.9988301396369934, 0.9987216591835022, 0.9991784691810608, 0.9990774989128113, 0.9991139769554138, 0.9983388781547546, 0.9987472891807556, 0.9987281560897827, 0.998774528503418, 0.9989747405052185, 0.9989426732063293, 0.998720645904541, 0.9992092251777649, 0.9990993142127991, 0.998896598815918, 0.9989545941352844, 0.9988551139831543, 0.9992266893386841]

    malicious_sim = [0.851254403591156, 0.8518784046173096, 0.8578312993049622, 0.852301299571991, 0.8675633668899536, 0.8769083619117737, 0.8568780422210693, 0.8710199594497681, 0.846804678440094, 0.8697628974914551, 0.8616177439689636, 0.8547340631484985, 0.8544197678565979, 0.8575555086135864, 0.8631234765052795, 0.8639386296272278, 0.8609784245491028, 0.8655211329460144, 0.8569314479827881, 0.8704941868782043, 0.8583366870880127, 0.8641974329948425, 0.8648791909217834, 0.8701789379119873, 0.8723769783973694, 0.86505526304245, 0.8612871766090393, 0.8693718314170837, 0.8677935600280762, 0.8661476373672485, 0.8572537899017334, 0.854709267616272, 0.8634025454521179, 0.8553453683853149, 0.8738261461257935, 0.8708531856536865, 0.8692907094955444, 0.8679090142250061, 0.8764702081680298, 0.8605243563652039, 0.8576661348342896, 0.859758734703064, 0.8671450018882751, 0.8642184734344482, 0.8605032563209534, 0.8609277606010437, 0.8545194864273071, 0.8798995018005371, 0.8504216074943542, 0.8704022169113159, 0.8664889335632324, 0.8634347319602966, 0.8524656891822815, 0.8632352352142334, 0.8767605423927307, 0.8650884032249451, 0.8552966713905334, 0.8583961725234985, 0.8573153018951416, 0.8718429207801819, 0.8554079532623291, 0.859636664390564, 0.8739964365959167, 0.8636473417282104, 0.8521159291267395, 0.8609097599983215, 0.8648548126220703, 0.8620108962059021, 0.8594261407852173, 0.8640244603157043, 0.8573148846626282, 0.8669112324714661, 0.871389627456665, 0.8662258982658386, 0.8642030358314514, 0.8747323155403137, 0.8466678261756897, 0.8543708920478821, 0.8563201427459717, 0.8602284789085388, 0.863050639629364, 0.8626217246055603, 0.8743965029716492, 0.8605124354362488, 0.8705880641937256, 0.8632969856262207, 0.8557627201080322, 0.8666282892227173, 0.8668138980865479, 0.8689245581626892, 0.8553476333618164, 0.8616674542427063, 0.8558403253555298, 0.8680502772331238, 0.8647029995918274, 0.8581770658493042, 0.8697757124900818, 0.866780698299408, 0.8647732138633728, 0.8551317453384399, 0.8654280304908752, 0.8661993741989136, 0.8622331023216248, 0.8743957877159119, 0.8616968393325806, 0.8647102117538452, 0.8631013631820679, 0.8586447834968567, 0.8574556708335876, 0.8592124581336975, 0.8563934564590454, 0.8633851408958435, 0.8563670516014099, 0.8576452732086182, 0.8644729256629944, 0.8482638597488403, 0.859150767326355, 0.8599374890327454, 0.8701937198638916, 0.8572349548339844, 0.8620812892913818, 0.8593452572822571, 0.8602912425994873, 0.8602871298789978, 0.8630952835083008, 0.8622170686721802, 0.870597779750824, 0.8639354705810547, 0.8605130910873413, 0.8541406393051147, 0.8533326983451843, 0.8559689521789551, 0.8669120073318481, 0.8586196303367615, 0.8607760071754456, 0.8623552918434143, 0.8560711741447449, 0.8753622174263, 0.8656772375106812, 0.8607755899429321, 0.8628010749816895, 0.8464977145195007, 0.8654162883758545, 0.8628517389297485, 0.8648965358734131, 0.8638206720352173, 0.8617518544197083, 0.8543457388877869, 0.8569245338439941, 0.8601971864700317, 0.8645018935203552, 0.8634657263755798, 0.8760097622871399, 0.8569859266281128, 0.8598979711532593, 0.8596481680870056, 0.8628723621368408, 0.851760983467102, 0.8638440370559692, 0.8496736288070679, 0.855701744556427, 0.8614219427108765, 0.8610810041427612, 0.8490903377532959, 0.8491190671920776, 0.8581461906433105, 0.8629959225654602, 0.8674981594085693, 0.8582454323768616, 0.8602968454360962, 0.8736564517021179, 0.8812674880027771, 0.8605782985687256, 0.8519333004951477, 0.8560510277748108, 0.862636923789978, 0.8574215769767761, 0.8655281662940979, 0.8681526780128479, 0.8617175221443176, 0.8658279776573181, 0.8642563819885254, 0.8564223051071167, 0.8622217178344727, 0.8664650321006775, 0.8647427558898926, 0.8651471138000488, 0.8675602674484253, 0.8500097393989563, 0.8553526401519775, 0.8621116876602173, 0.8608492016792297, 0.8560066223144531, 0.8691343069076538, 0.8745322823524475, 0.8665139675140381, 0.8600106835365295, 0.8607097268104553]

    top_k_sim = [0.9998005628585815, 0.9998019337654114, 0.9998002052307129, 0.9997301697731018, 0.9997435212135315, 0.9997798204421997, 0.9997180104255676, 0.999711811542511, 0.9997055530548096, 0.9997110366821289, 0.9997251629829407, 0.9996236562728882, 0.999668538570404, 0.9996511936187744, 0.999678373336792, 0.9996823072433472, 0.9996758699417114, 0.9997148513793945, 0.9996635317802429, 0.9997066259384155, 0.9997045397758484, 0.999708354473114, 0.9996910095214844, 0.9996441006660461, 0.9997377991676331, 0.9996454119682312, 0.9997036457061768, 0.9997392892837524, 0.99972003698349, 0.9997092485427856, 0.9996490478515625, 0.9996433258056641, 0.9996861219406128, 0.9996969699859619, 0.9997578859329224, 0.9997421503067017, 0.999748945236206, 0.9997406601905823, 0.9997556805610657, 0.9997028708457947, 0.9996947050094604, 0.9996389746665955, 0.9997073411941528, 0.9997043013572693, 0.9996833205223083, 0.9997398853302002, 0.9996570348739624, 0.9997509717941284, 0.9996771812438965, 0.9997100830078125, 0.9997540712356567, 0.9997209310531616, 0.9996387958526611, 0.9996483325958252, 0.9997435808181763, 0.9997015595436096, 0.9997243881225586, 0.999663770198822, 0.9996758103370667, 0.9997177124023438, 0.9997101426124573, 0.999725341796875, 0.9997255802154541, 0.9997018575668335, 0.9996178150177002, 0.9997356534004211, 0.9997245669364929, 0.9997209906578064, 0.9997102618217468, 0.9996575713157654, 0.9996823072433472, 0.9996263384819031, 0.9997241497039795, 0.999691367149353, 0.9996575713157654, 0.9997158050537109, 0.9838161468505859, 0.8922714591026306, 0.9951326251029968, 0.999085545539856, 0.9986903667449951, 0.9992969036102295, 0.9994328022003174, 0.9994019269943237, 0.9995375275611877, 0.9994061589241028, 0.9992053508758545, 0.9993622303009033, 0.9992175698280334, 0.9995487928390503, 0.9992991089820862, 0.9994327425956726, 0.999459445476532, 0.9995216131210327, 0.9993705153465271, 0.9994692802429199, 0.9995556473731995, 0.9995612502098083, 0.999510645866394, 0.9994677305221558, 0.9995887875556946, 0.9995617270469666, 0.99950110912323, 0.9995124340057373, 0.9995018243789673, 0.9994893074035645, 0.9995582699775696, 0.9994745254516602, 0.999347984790802, 0.9992914795875549, 0.9993367791175842, 0.999423623085022, 0.999350905418396, 0.9994513988494873, 0.9994966387748718, 0.9989356398582458, 0.9993692636489868, 0.9994654655456543, 0.9994972348213196, 0.9994843006134033, 0.9992245435714722, 0.9994886517524719, 0.9994868040084839, 0.999501645565033, 0.9994999170303345, 0.9995077848434448, 0.9995043873786926, 0.9994848370552063, 0.9994196891784668, 0.9994290471076965, 0.9992446303367615, 0.9994921684265137, 0.9995468854904175, 0.9994772672653198, 0.9992632865905762, 0.9994802474975586, 0.999363899230957, 0.9995293617248535, 0.9994988441467285, 0.9994927048683167, 0.9995041489601135, 0.9991207122802734, 0.9992789626121521, 0.9995287656784058, 0.9994714856147766, 0.9995071887969971, 0.9995340704917908, 0.9992790818214417, 0.9994340538978577, 0.9994083642959595, 0.9994688034057617, 0.9992254972457886, 0.9995431303977966, 0.9992230534553528, 0.9994463324546814, 0.9990308880805969, 0.9994179010391235, 0.9992936849594116, 0.9992884993553162, 0.9991387724876404, 0.9990119934082031, 0.9993934035301208, 0.9994879961013794, 0.9991850256919861, 0.9992278218269348, 0.9993845224380493, 0.9994806051254272, 0.9994935989379883, 0.9993523955345154, 0.9994449019432068, 0.999512255191803, 0.9995720982551575, 0.999345064163208, 0.9993036389350891, 0.9994785189628601, 0.9994997382164001, 0.9994292855262756, 0.9993770122528076, 0.9995148181915283, 0.9993545413017273, 0.9995197057723999, 0.9995049834251404, 0.9994171857833862, 0.9994543194770813, 0.9994193315505981, 0.9994771480560303, 0.9994402527809143, 0.9995307326316833, 0.9989776015281677, 0.9993573427200317, 0.9994759559631348, 0.9992482662200928, 0.9994925260543823, 0.9994789361953735, 0.9995041489601135, 0.9994645118713379, 0.999289870262146, 0.9994804859161377]


    plt.plot(x, honest_sim, 's-', markersize=0, linewidth=5, c='#2dabb2', label='Honest', alpha=1)
    plt.plot(x, malicious_sim, 'o-', markersize=0, linewidth=5, c='#daab36', label='Compromised', alpha=1)
    plt.plot(x, top_k_sim, 'p-', markersize=0, linewidth=2, c='#f0552b', label='Top-K', alpha=1)

    plt.show()
    fig.savefig('./result/experiment1_5.pdf', bbox_inches='tight')

def experiment1_6():
    fig = plt.figure(figsize=(9, 7), dpi=100)
    plt.xlabel("Global Rounds", fontdict={'size': 30})
    plt.ylabel("Cosine Similarity", fontdict={'size': 30})
    plt.xticks(np.arange(0, 201, 40), size=30)
    plt.yticks(size=30)
    plt.xlim(0, 200)

    x = []
    for i in range(3, 201):
        x.append(i)

    honest_sim = [0.9995009899139404, 0.9996614456176758, 0.9995163083076477, 0.9995768070220947, 0.9996626973152161, 0.9995911121368408, 0.999452531337738, 0.9995192885398865, 0.9996307492256165, 0.9996042847633362, 0.9996504187583923, 0.9996364712715149, 0.9996585845947266, 0.9996406435966492, 0.99958336353302, 0.9996638298034668, 0.9996334314346313, 0.9996456503868103, 0.9996479153633118, 0.999627947807312, 0.9995465874671936, 0.9996581673622131, 0.9996232986450195, 0.9996709227561951, 0.9996345043182373, 0.999707818031311, 0.9995952248573303, 0.9996492862701416, 0.9996568560600281, 0.9995999336242676, 0.9996182322502136, 0.9996143579483032, 0.9996618628501892, 0.9996109008789062, 0.9995949268341064, 0.9995954632759094, 0.9996843338012695, 0.9996402859687805, 0.9996568560600281, 0.9996627569198608, 0.9996865391731262, 0.999628484249115, 0.9996525049209595, 0.9996317028999329, 0.9996538162231445, 0.9996709823608398, 0.999631404876709, 0.9996782541275024, 0.9996818900108337, 0.9996686577796936, 0.9996469616889954, 0.999704897403717, 0.9996356964111328, 0.9996489882469177, 0.9996663331985474, 0.9996410608291626, 0.9996118545532227, 0.9996811747550964, 0.9996810555458069, 0.9996878504753113, 0.9996647238731384, 0.9996979236602783, 0.9996289610862732, 0.9996916651725769, 0.999674916267395, 0.9996803402900696, 0.9996482729911804, 0.9996708035469055, 0.9996737241744995, 0.9996493458747864, 0.999612033367157, 0.9996789693832397, 0.9996544718742371, 0.9996148347854614, 0.99959397315979, 0.9995725750923157, 0.9996623992919922, 0.9995859861373901, 0.9996445775032043, 0.999693751335144, 0.9996992349624634, 0.9996833801269531, 0.9996573328971863, 0.9996647238731384, 0.9996020197868347, 0.9996896982192993, 0.9996866583824158, 0.9996811747550964, 0.9996650218963623, 0.9996410608291626, 0.999625027179718, 0.9996521472930908, 0.9997033476829529, 0.9997093677520752, 0.9996447563171387, 0.9996371865272522, 0.999664843082428, 0.9996600151062012, 0.9996504783630371, 0.9996426701545715, 0.9996502995491028, 0.9996956586837769, 0.9996593594551086, 0.9996767044067383, 0.9996431469917297, 0.9996723532676697, 0.9996273517608643, 0.999634325504303, 0.9995888471603394, 0.9996373653411865, 0.999668300151825, 0.9996517896652222, 0.9996210336685181, 0.9996427893638611, 0.9996537566184998, 0.9996770620346069, 0.9996765851974487, 0.9996865391731262, 0.9996781945228577, 0.9996740221977234, 0.9997035264968872, 0.9996609091758728, 0.9996463656425476, 0.9996222257614136, 0.9996762871742249, 0.9996547102928162, 0.9996901750564575, 0.99968421459198, 0.9996598362922668, 0.9996628165245056, 0.9996150135993958, 0.9996302127838135, 0.9996328353881836, 0.9996832013130188, 0.999620258808136, 0.9996540546417236, 0.9996622204780579, 0.9997045397758484, 0.999686062335968, 0.9996915459632874, 0.9996786117553711, 0.9996866583824158, 0.999707818031311, 0.9996582865715027, 0.9996926188468933, 0.9996824264526367, 0.9997157454490662, 0.9996750950813293, 0.9996889233589172, 0.999690592288971, 0.999712347984314, 0.999674916267395, 0.9996947646141052, 0.9996970295906067, 0.9996752142906189, 0.999707818031311, 0.9996540546417236, 0.9996767044067383, 0.9996655583381653, 0.9996516108512878, 0.9996841549873352, 0.9996763467788696, 0.9996694922447205, 0.9995956420898438, 0.9996854066848755, 0.9996489882469177, 0.9996871948242188, 0.9996943473815918, 0.9996499419212341, 0.9996879696846008, 0.9997028708457947, 0.9996793866157532, 0.9996932148933411, 0.9996968507766724, 0.9996727108955383, 0.9996482729911804, 0.9996475577354431, 0.9996377825737, 0.999697208404541, 0.9996655583381653, 0.9996433258056641, 0.9996742010116577, 0.9996451735496521, 0.9996500015258789, 0.9996921420097351, 0.9996877312660217, 0.9996711015701294, 0.9996520280838013, 0.99968421459198, 0.9996887445449829, 0.9996687769889832, 0.9996817708015442, 0.9997060894966125, 0.9996756315231323, 0.9996929168701172, 0.9996637105941772, 0.9996680021286011, 0.9996656775474548]

    malicious_sim = [0.8665245771408081, 0.8564432263374329, 0.8576724529266357, 0.8591880202293396, 0.8683295845985413, 0.8674039840698242, 0.8575173616409302, 0.8616525530815125, 0.8622381687164307, 0.857162356376648, 0.8692391514778137, 0.8550371527671814, 0.8630053400993347, 0.855728268623352, 0.8618047833442688, 0.8578362464904785, 0.8629560470581055, 0.8676905035972595, 0.8634293079376221, 0.8695982694625854, 0.8829676508903503, 0.8655087351799011, 0.8549098372459412, 0.85929936170578, 0.8570760488510132, 0.8695505857467651, 0.8624390363693237, 0.8583007454872131, 0.8668200373649597, 0.867326557636261, 0.8703547716140747, 0.866400420665741, 0.8552066087722778, 0.8518480658531189, 0.8563060164451599, 0.8585469722747803, 0.8620744943618774, 0.8562391400337219, 0.862920880317688, 0.858629047870636, 0.8602596521377563, 0.8599514365196228, 0.8656764030456543, 0.8602836728096008, 0.8695532083511353, 0.8600106239318848, 0.8604481816291809, 0.8546697497367859, 0.8562397956848145, 0.8626018762588501, 0.8518756031990051, 0.8660398125648499, 0.8510209321975708, 0.8629884123802185, 0.8624902963638306, 0.860733151435852, 0.8663936853408813, 0.857631266117096, 0.856819212436676, 0.8606045842170715, 0.8563808798789978, 0.8506717681884766, 0.8622879385948181, 0.8542928099632263, 0.8547857999801636, 0.8563060164451599, 0.8765811920166016, 0.8538212776184082, 0.8597077131271362, 0.8673799633979797, 0.8691189885139465, 0.8611212372779846, 0.8733831644058228, 0.8621934652328491, 0.8683710098266602, 0.868355393409729, 0.8595669865608215, 0.8651574850082397, 0.8582702279090881, 0.8619164824485779, 0.8686968088150024, 0.8653572201728821, 0.8649428486824036, 0.8603228330612183, 0.8629055023193359, 0.8602191209793091, 0.8636213541030884, 0.8594321012496948, 0.8554566502571106, 0.8575601577758789, 0.8623794913291931, 0.863138735294342, 0.8622714877128601, 0.8596121668815613, 0.8593483567237854, 0.8562062382698059, 0.8590443134307861, 0.8595191240310669, 0.8724163174629211, 0.8606133460998535, 0.8612653613090515, 0.8646479249000549, 0.8591288924217224, 0.8599712252616882, 0.8600431680679321, 0.8607921004295349, 0.8606151342391968, 0.8651398420333862, 0.8561959862709045, 0.8522180318832397, 0.8670182228088379, 0.8502893447875977, 0.8649324774742126, 0.8619140386581421, 0.860489010810852, 0.8635079860687256, 0.8637855648994446, 0.8570151925086975, 0.8559749722480774, 0.863743007183075, 0.8609905242919922, 0.8565991520881653, 0.8570209741592407, 0.8604788780212402, 0.8620043396949768, 0.8542198538780212, 0.8607245683670044, 0.8697953224182129, 0.8545308113098145, 0.865219235420227, 0.8679441213607788, 0.8577497601509094, 0.8657435774803162, 0.8557305335998535, 0.8680154085159302, 0.8620358109474182, 0.8619688153266907, 0.860023558139801, 0.8653203845024109, 0.8799387812614441, 0.8556267023086548, 0.8542314767837524, 0.8723804950714111, 0.8583685755729675, 0.8575019836425781, 0.8503566980361938, 0.8667397499084473, 0.855487048625946, 0.8557888865470886, 0.8554670810699463, 0.8594056963920593, 0.8604214787483215, 0.8520752191543579, 0.8600807785987854, 0.8624958992004395, 0.8605050444602966, 0.8601577281951904, 0.86396723985672, 0.8681992888450623, 0.8643708229064941, 0.8645326495170593, 0.8625127077102661, 0.8595466017723083, 0.8545751571655273, 0.8563133478164673, 0.8577988743782043, 0.8686383366584778, 0.8606004118919373, 0.8526919484138489, 0.8512746691703796, 0.8634032607078552, 0.8588822484016418, 0.8577544093132019, 0.8634581565856934, 0.8606523275375366, 0.8645970225334167, 0.861073911190033, 0.8615072965621948, 0.857521116733551, 0.8694488406181335, 0.8701502680778503, 0.8539072871208191, 0.8548750281333923, 0.8572933077812195, 0.8586010932922363, 0.8541622757911682, 0.8664471507072449, 0.8543843626976013, 0.8566727042198181, 0.8657979369163513, 0.8605784773826599, 0.8491283059120178, 0.8618676066398621, 0.8575844764709473, 0.8640047311782837, 0.8646653294563293, 0.8655530214309692, 0.8583233952522278]

    top_k_sim = [0.9997673630714417, 0.9997698068618774, 0.9997293949127197, 0.9997298121452332, 0.9998555183410645, 0.9998071789741516, 0.9997508525848389, 0.9998308420181274, 0.9998428821563721, 0.9998505711555481, 0.9998309016227722, 0.9997326135635376, 0.9997944831848145, 0.9997467994689941, 0.9997881054878235, 0.999788761138916, 0.9998131990432739, 0.9998503923416138, 0.9998085498809814, 0.9998718500137329, 0.9998443126678467, 0.9998587369918823, 0.9998086094856262, 0.9998432993888855, 0.9997731447219849, 0.9998373985290527, 0.9998100996017456, 0.9997825026512146, 0.999856173992157, 0.9998255372047424, 0.9998522996902466, 0.9998114705085754, 0.9998255968093872, 0.9997658133506775, 0.9997642040252686, 0.9997753500938416, 0.9998387098312378, 0.9998270273208618, 0.9998058080673218, 0.9998042583465576, 0.999844491481781, 0.9998353719711304, 0.9998381733894348, 0.9997738599777222, 0.9998509883880615, 0.9998446106910706, 0.9996986389160156, 0.9997618794441223, 0.9997636079788208, 0.9998112320899963, 0.9998019933700562, 0.9998409152030945, 0.9997003078460693, 0.9998076558113098, 0.9998429417610168, 0.999836802482605, 0.9998165965080261, 0.999786376953125, 0.9997355341911316, 0.9997862577438354, 0.9997875690460205, 0.9998100399971008, 0.9998601078987122, 0.9997449517250061, 0.9997988939285278, 0.9997410178184509, 0.9998319149017334, 0.999807596206665, 0.9998241662979126, 0.9998268485069275, 0.9998353719711304, 0.9998421669006348, 0.9998497366905212, 0.999770998954773, 0.9998431205749512, 0.9998300671577454, 0.9998211860656738, 0.9998041391372681, 0.9997925162315369, 0.9998362064361572, 0.9998375177383423, 0.9998496770858765, 0.9998488426208496, 0.9997520446777344, 0.9998335242271423, 0.9998145699501038, 0.9998345375061035, 0.9998465180397034, 0.9998257160186768, 0.9998059272766113, 0.9998486638069153, 0.999839186668396, 0.9998469948768616, 0.9997552633285522, 0.9997754096984863, 0.9997777938842773, 0.9998264908790588, 0.9998258352279663, 0.9998418688774109, 0.9998395442962646, 0.9998354315757751, 0.9998496770858765, 0.9998455047607422, 0.9998371005058289, 0.9998196959495544, 0.9998474717140198, 0.9998036623001099, 0.999842643737793, 0.9997473955154419, 0.9997391700744629, 0.9998494386672974, 0.9997686743736267, 0.99984210729599, 0.9998418092727661, 0.999841034412384, 0.9997912645339966, 0.9998406171798706, 0.999768853187561, 0.9998104572296143, 0.9998287558555603, 0.9998469352722168, 0.9998167753219604, 0.999829888343811, 0.9998073577880859, 0.9998406171798706, 0.9997974634170532, 0.9998233318328857, 0.999846875667572, 0.9998219609260559, 0.9998170137405396, 0.9998268485069275, 0.9997777342796326, 0.9998308420181274, 0.9998156428337097, 0.9998258948326111, 0.9998248219490051, 0.9998288154602051, 0.9997681975364685, 0.9998494386672974, 0.9998494386672974, 0.9997910261154175, 0.9997998476028442, 0.9998500943183899, 0.9998106956481934, 0.9998146295547485, 0.99976646900177, 0.9998719096183777, 0.9998154640197754, 0.999786913394928, 0.9997562170028687, 0.9998191595077515, 0.9997437000274658, 0.9997808933258057, 0.9998316764831543, 0.9998201727867126, 0.9998272061347961, 0.9998039603233337, 0.9998348951339722, 0.9998341202735901, 0.999845027923584, 0.999788761138916, 0.9997701644897461, 0.9998330473899841, 0.9996498823165894, 0.9997638463973999, 0.9997755289077759, 0.9998396039009094, 0.9998223781585693, 0.9997910261154175, 0.9997738599777222, 0.999837338924408, 0.9998320937156677, 0.9998183846473694, 0.9998446702957153, 0.9998245239257812, 0.9998473525047302, 0.9997962713241577, 0.9998530745506287, 0.9997707009315491, 0.9998408555984497, 0.9998422265052795, 0.9998134970664978, 0.9998081922531128, 0.9997645020484924, 0.999853253364563, 0.9997462034225464, 0.9998160004615784, 0.9997737407684326, 0.9997963309288025, 0.9998387098312378, 0.9998456239700317, 0.9997503757476807, 0.999815821647644, 0.9997909069061279, 0.9998435974121094, 0.9998096227645874, 0.9998087882995605, 0.9997592568397522]


    plt.plot(x, honest_sim, 's-', markersize=0, linewidth=5, c='#2dabb2', label='Honest', alpha=1)
    plt.plot(x, malicious_sim, 'o-', markersize=0, linewidth=5, c='#daab36', label='Compromised', alpha=1)
    plt.plot(x, top_k_sim, 'p-', markersize=0, linewidth=2, c='#f0552b', label='Top-K', alpha=1)

    plt.show()
    fig.savefig('./result/experiment1_6.pdf', bbox_inches='tight')


def k_means():
    id_features=[(89, -0.08697088807821274), (45, -0.08311767131090164), (100, -0.07430581003427505), (86, -0.0698883980512619), (20, -0.06881983578205109), (80, -0.06748076528310776), (60, -0.062390487641096115), (36, -0.05672210082411766), (77, -0.041250262409448624), (3, -0.03413698822259903), (9, -0.01853957027196884), (46, -0.013134283944964409), (70, -0.011807005852460861), (35, -0.00898679532110691), (98, -0.008838018402457237), (6, 0.0057137031108140945), (31, 0.008879594504833221), (12, 0.020149236544966698), (63, 0.02165883406996727), (82, 0.028307314962148666), (66, 0.03116026148200035), (24, 0.031316131353378296), (5, 0.03281974792480469), (75, 0.03317195549607277), (83, 0.03489980101585388), (1, 0.03685259073972702), (94, 0.038662590086460114), (13, 0.041017912328243256), (15, 0.04422789812088013), (32, 0.04472271353006363), (96, 0.046798575669527054), (62, 0.0488424152135849), (79, 0.05341720953583717), (65, 0.0606708750128746), (53, 0.06891043484210968), (11, 0.0693841204047203), (57, 0.07505548745393753), (87, 0.08612965047359467), (2, 0.11673156172037125), (4, 0.1487927883863449), (41, 0.6563588380813599), (85, 0.7773104906082153), (95, 0.8762059211730957), (44, 0.9290896058082581), (59, 0.9706631302833557), (27, 0.976511538028717), (51, 0.9766933917999268), (68, 0.9773481488227844), (40, 0.9797688126564026), (55, 0.9799339771270752), (71, 0.9818869829177856), (69, 0.9833162426948547), (38, 0.983726978302002), (19, 0.983828067779541), (50, 0.9844707250595093), (64, 0.9846603274345398), (84, 0.9847246408462524), (72, 0.9848741888999939), (43, 0.9849197864532471), (8, 0.9851168394088745), (29, 0.9852069020271301), (14, 0.986009418964386), (58, 0.9861316680908203), (81, 0.986319363117218), (67, 0.9864485263824463), (33, 0.9866939187049866), (28, 0.9867429733276367), (92, 0.9872018098831177), (76, 0.9877097606658936), (56, 0.9880548715591431), (49, 0.9880948662757874), (39, 0.9881542921066284), (34, 0.9883559942245483), (78, 0.9884623289108276), (90, 0.9885345697402954), (22, 0.9888278245925903), (26, 0.9888403415679932), (16, 0.989082932472229), (61, 0.9891228675842285), (97, 0.9894190430641174), (99, 0.9896077513694763), (18, 0.989632248878479), (93, 0.9900003671646118), (23, 0.9902206659317017), (88, 0.9902259707450867), (52, 0.9902914762496948), (17, 0.9903789758682251), (37, 0.990394115447998), (73, 0.9906416535377502), (48, 0.9909740686416626), (10, 0.9910876154899597), (7, 0.991101861000061), (25, 0.9911572933197021), (30, 0.9914921522140503), (42, 0.9917742013931274), (74, 0.9917922616004944), (47, 0.9918253421783447), (54, 0.9918662309646606), (91, 0.9924580454826355), (21, 0.9946654438972473)]
    labels=[]
    features=[]
    for i in range(len(id_features)):
        features.append(id_features[i][1])
        if i>=40:
            labels.append(1)
        else:
            labels.append(0)
    features=np.column_stack([features, np.zeros_like(features)])

    classes = ['compromised', 'honest']
    custom_palette = [(255/255, 92/255, 92/255), (64/255, 218/255, 255/255)]
    label_class = [classes[i].capitalize() for i in labels]

    tsne = TSNE(n_components=2, init="random", random_state=0)
    tsne_result = tsne.fit_transform(features)

    if torch.is_tensor(tsne_result):
        tsne_result = tsne_result.cpu().numpy()
    if torch.is_tensor(label_class):
        label_class = label_class.cpu().numpy()

    x_min, x_max = np.min(tsne_result, 0), np.max(tsne_result, 0)
    tsne_result = (tsne_result - x_min) / (x_max - x_min)
    tsne_result_df = pd.DataFrame(
        {" ": tsne_result[:, 0],
            "  ": tsne_result[:, 1], "labels": label_class}
    )
    fig, ax = plt.subplots(1, figsize=(7, 5))
    num_class = len(pd.unique(tsne_result_df["labels"]))
    if custom_palette is None:
        custom_palette = sns.color_palette("hls", num_class)
        print(custom_palette)

    sns.scatterplot(
        x=" ",
        y="  ",
        hue="labels",
        data=tsne_result_df,
        ax=ax,
        s=200,
        palette=custom_palette,
        alpha=1,
    )

    plt.xticks(size=30)
    plt.yticks(size=30)

    # ax.legend(fontsize=30, visible=False)
    plt.tight_layout()
    plt.show()
    fig.savefig('../result/cifar10,pr=0.4,k-means.pdf', bbox_inches='tight')




if __name__ == '__main__':
    k_means()
